# HoopStats - מערכת ניהול סטטיסטיקות כדורסל NBA

![לוגו בית הספר](https://scontent.ftlv6-1.fna.fbcdn.net/v/t39.30808-1/458827628_1145420530309029_4536608350419783600_n.jpg?stp=dst-jpg_s480x480_tt6&_nc_cat=100&ccb=1-7&_nc_sid=2d3e12&_nc_ohc=2WdHXGoMo6cQ7kNvwGzbzFy&_nc_oc=Adnl3Gql2ARDDrsJ0PJwlt-imB1ejS76I04e_NMgWuZ5H0eWbm1wg-_bWxSptq_4xYg&_nc_zt=24&_nc_ht=scontent.ftlv6-1.fna&_nc_gid=La-o9GOW6hxGO7-z08zytA&oh=00_AfJmRKHZZsvDup12TugzusUMzyz9BBVQ3tgkt4BgOA6nuA&oe=6840EB8C)

## פרטי התלמיד

- **שם התלמיד:** רום קרקובסקי
- **תעודת זהות:** 218687614
- **שנת לימודים:** תשפ"ה
- **מגמה:** פיזיקה מחשבים

---

## תיאור הפרויקט

HoopStats היא מערכת מתקדמת לניהול וניתוח סטטיסטיקות NBA הכוללת אינטגרציה ישירה עם API הרשמי של ה-NBA. המערכת מספקת מידע מקיף על שחקנים, קבוצות ומשחקים עם ממשק בעברית מלא ותמיכה ב-RTL. המערכת כוללת יכולות ניתוח מתקדמות, מעקב אחר ביצועים, ומערכת ניהול משתמשים מקיפה.

## טכנולוגיות ושפות תכנות

### Backend

- **C# .NET 8.0** - שפת התכנות העיקרית
- **ASP.NET Core 8.0 MVC** - מסגרת עבודה לפיתוח אפליקציות אינטרנט
- **Entity Framework Core 9.0.3** - ORM לניהול מסד הנתונים
- **SQLite** - מסד נתונים מקומי עם אינדקסים מותאמים
- **CsvHelper 33.0.1** - עיבוד קבצי CSV
- **Newtonsoft.Json 13.0.3** - עיבוד JSON מה-NBA API

### Frontend

- **HTML5** - שפת סימון עם תמיכה ב-RTL
- **CSS3** - עיצוב מתקדם עם Bootstrap וקבצי CSS מותאמים
- **JavaScript** - תכנות צד לקוח עם Chart.js לגרפים
- **Bootstrap 5** - מסגרת עיצוב רספונסיבית
- **SVG Graphics** - לוגואים של כל 30 קבוצות NBA

### אינטגרציות חיצוניות

- **NBA Official API** - אינטגרציה ישירה עם stats.nba.com
- **HTTP Client** - לשליפת נתונים בזמן אמת
- **JSON Processing** - עיבוד תגובות API אוטומטי

### אבטחה

- **BCrypt.Net-Next 4.0.3** - הצפנת סיסמאות עם מלח (salt)
- **Cookie Authentication** - אימות מבוסס עוגיות
- **Session Management** - ניהול הפעלות משתמשים מאובטח
- **Role-Based Access** - הרשאות מנהל ומשתמש רגיל

## תכונות עיקריות

### 1. ניהול משתמשים ואבטחה

- **רישום משתמשים חדשים** - טופס רישום מאובטח עם אימות נתונים
- **התחברות למערכת** - אימות משתמשים עם סיסמאות מוצפנות BCrypt
- **ניהול מנהלים מתקדם** - מערכת הרשאות מקיפה עם:
  - ממשק ניהול משתמשים מיוחד למנהלים (ManageUsers.cshtml)
  - יכולת עריכת פרטי משתמשים (EditUser.cshtml)
  - אפשרות מחיקת משתמשים
  - הפיכת משתמשים למנהלים
  - שדה IsAdmin במסד הנתונים עם מיגרציה AddIsAdminToUser
- **הגנה על נתונים** - אינדקסים ייחודיים ובדיקות תקינות
- **ניתוב מותנה הרשאות** - קישורי ניהול מוצגים רק למנהלים בתפריט הניווט

### 2. סטטיסטיקות NBA מתקדמות

- **סטטיסטיקות שחקנים מפורטות** - נתוני ביצועים מקיפים כולל:
  - נקודות, ריבאונדים, אסיסטים לכל משחק וממוצעים
  - אחוזי זריקה, זריקות תלת נקודתיות, זריקות חופשיות
  - גניבות, חסימות, הפסדים, עבירות אישיות
  - מדד יעילות (GameScore) ומדדים מתקדמים
- **ניתוח קבוצות** - סטטיסטיקות קבוצתיות עם השוואות ביצועים
- **פרטי משחקים מקיפים** - ניתוח מעמיק של כל משחק עם:
  - צבעי ביצועים (ירוק/אדום לפי ביצועים)
  - זיהוי הישגים (דאבל-דאבל, טריפל-דאבל)
  - מדדי יעילות מתקדמים
- **משחקים אחרונים** - תוצאות עדכניות עם זיהוי שחקנים מובילים

### 3. אינטגרציה עם NBA API

- **עדכון נתונים בזמן אמת** - חיבור ישיר לשרת הרשמי של NBA
- **נתוני עונות מרובות** - תמיכה בעונות 2000-2025
- **עדכון אוטומטי** - משיכת נתונים ועדכון מסד הנתונים
- **עיבוד נתונים חכם** - המרה אוטומטית של פורמטי NBA לפורמט המערכת

### 4. ממשק משתמש מתקדם

- **עיצוב רספונסיבי מלא** - תמיכה מושלמת במכשירים שונים
- **ממשק בעברית מלא** - תמיכה ב-RTL ותרגום מלא לעברית
- **לוגואי קבוצות** - כל 30 קבוצות NBA עם לוגואים באיכות גבוהה
- **צבעי ביצועים** - קידוד צבעים לזיהוי מהיר של ביצועים
- **גרפים וחזותיות** - Chart.js לייצוג גרפי של נתונים
- **חיפוש וסינון** - יכולות חיפוש מתקדמות בנתונים

### 5. ניהול נתונים

- **ייבוא CSV** - יכולת ייבוא נתוני סטטיסטיקות מקבצי CSV
- **עיבוד נתונים בכמויות גדולות** - טיפול יעיל בנתוני עונות שלמות
- **אינדקסים מותאמים** - אופטימיזציה למהירות שאילתות

## מבנה הפרויקט

```plaintext
HoopStats/
├── Controllers/              # בקרים (MVC Controllers)
│   ├── HomeController.cs     # דף הבית, אודות, שגיאות
│   ├── StatsController.cs    # סטטיסטיקות שחקנים וקבוצות
│   ├── UserController.cs     # ניהול משתמשים ואימות
│   └── DataController.cs     # אינטגרציה עם NBA API
├── Models/                   # מודלים ומבני נתונים
│   ├── User.cs              # מודל משתמש עם הרשאות
│   ├── GameStats.cs         # סטטיסטיקות משחק מפורטות
│   ├── TeamInfo.cs          # מידע קבוצות NBA
│   ├── NBAApiModels.cs      # מודלים לאינטגרציה עם NBA API
│   ├── ViewModels/          # מודלי תצוגה
│   │   ├── LoginViewModel.cs
│   │   ├── RegisterViewModel.cs
│   │   ├── PlayerStatsViewModel.cs
│   │   ├── TeamStatsViewModel.cs
│   │   └── GameDetailsViewModel.cs
│   ├── Extensions/          # הרחבות ועזרים
│   │   ├── DateTimeExtensions.cs
│   │   ├── GameStatExtensions.cs
│   │   └── DateFormatHelper.cs
│   └── dbContext.cs         # הקשר מסד נתונים
├── Views/                   # תבניות HTML/Razor
│   ├── Home/               # דפי בית ואודות
│   │   ├── Index.cshtml
│   │   ├── Login.cshtml
│   │   ├── Register.cshtml
│   │   ├── ManageUsers.cshtml
│   │   ├── EditUser.cshtml
│   │   └── UpdateData.cshtml
│   ├── Stats/              # דפי סטטיסטיקות
│   │   ├── Index.cshtml         # סטטיסטיקות עדכניות
│   │   ├── PlayerStats.cshtml   # נתוני שחקן
│   │   ├── TeamStats.cshtml     # נתוני קבוצה
│   │   ├── GameDetails.cshtml   # פרטי משחק
│   │   ├── LatestGames.cshtml   # משחקים אחרונים
│   │   ├── PlayersList.cshtml   # רשימת שחקנים
│   │   ├── TeamsList.cshtml     # רשימת קבוצות
│   │   ├── TeamGames.cshtml     # משחקי קבוצה
│   │   └── Import.cshtml        # ייבוא נתונים
│   └── Shared/             # תבניות משותפות
│       ├── _Layout.cshtml   # תבנית ראשית
│       └── Error.cshtml     # דף שגיאות
├── Services/               # שירותי עזר ואבטחה
│   └── PasswordService.cs  # שירות הצפנת סיסמאות
├── wwwroot/               # קבצים סטטיים
│   ├── css/               # קבצי עיצוב
│   │   ├── site.css       # עיצוב כללי
│   │   ├── navbar.css     # תפריט ניווט
│   │   ├── stats-table.css # טבלאות סטטיסטיקות
│   │   ├── teams.css      # עיצוב קבוצות
│   │   └── player-stats.css # עיצוב נתוני שחקנים
│   ├── js/               # קבצי JavaScript
│   │   └── site.js       # פונקציות כלליות
│   ├── img/              # תמונות ולוגואים
│   │   └── teams/        # לוגואי 30 קבוצות NBA
│   └── lib/              # ספריות חיצוניות
│       ├── bootstrap/    # Bootstrap 5
│       ├── jquery/       # jQuery
│       └── chart.js/     # גרפים וחזותיות
├── Migrations/           # מיגרציות מסד נתונים
│   ├── InitialCreate.cs  # יצירת טבלאות בסיסיות
│   ├── AddGameStats.cs   # הוספת טבלת סטטיסטיקות
│   ├── AddGameStatsIndexes.cs # אינדקסים לביצועים
│   ├── AddIsAdminToUser.cs # הוספת הרשאות מנהל
│   └── HashExistingPasswords.cs # מיגרציית אבטחה
├── docs/                 # תיעוד הפרויקט
│   ├── instructions.md   # הוראות פיתוח
│   └── project-documentation.md # תיעוד מלא
└── Program.cs           # נקודת כניסה ראשית
```

## מסד הנתונים

### טבלאות עיקריות

#### 1. טבלת Users

- **Id** (int) - מפתח ראשי
- **FirstName** (string) - שם פרטי
- **LastName** (string) - שם משפחה  
- **Username** (string) - שם משתמש ייחודי
- **Email** (string) - כתובת אימייל ייחודית
- **Gender** (string) - מגדר
- **PasswordHash** (string) - סיסמה מוצפנת BCrypt (שונה מ-Password בעדכונים עדכניים)
- **IsAdmin** (bool) - הרשאות מנהל (נוסף ב-commit 6e3a3e4)

#### 2. טבלת GameStats (סטטיסטיקות מקיפות)

**מידע בסיסי:**

- **Id** (int) - מפתח ראשי
- **Player** (string) - שם השחקן
- **Team** (string) - קבוצה
- **Opponent** (string) - יריבה
- **Result** (string) - תוצאה (W/L)
- **GameDate** (DateTime) - תאריך המשחק

**סטטיסטיקות ביצועים:**

- **Points** (int) - נקודות
- **Minutes** (string) - דקות משחק
- **FieldGoalsMade/Attempted** (int) - זריקות שדה
- **FieldGoalPercentage** (double) - אחוז זריקות שדה
- **ThreePointersMade/Attempted** (int) - זריקות תלת נקודתיות
- **ThreePointPercentage** (double) - אחוז תלת נקודתיות
- **FreeThrowsMade/Attempted** (int) - זריקות חופשיות
- **FreeThrowPercentage** (double) - אחוז זריקות חופשיות

**סטטיסטיקות מתקדמות:**

- **OffensiveRebounds/DefensiveRebounds/TotalRebounds** (int) - ריבאונדים
- **Assists** (int) - אסיסטים
- **Steals** (int) - גניבות
- **Blocks** (int) - חסימות
- **Turnovers** (int) - הפסדים
- **PersonalFouls** (int) - עבירות אישיות
- **GameScore** (double) - מדד יעילות

#### 3. טבלת TeamInfo

- **Id** (int) - מפתח ראשי
- **TeamName** (string) - שם הקבוצה באנגלית
- **HebrewName** (string) - שם הקבוצה בעברית
- **LogoUrl** (string) - נתיב ללוגו הקבוצה

### אינדקסים ואופטימיזציה

- **אינדקס ייחודי** על Username ו-Email בטבלת Users
- **אינדקס על GameDate** לשאילתות מהירות לפי תאריך
- **אינדקס על Player** לחיפוש מהיר של שחקנים
- **אינדקס מורכב על (Team, Opponent)** לשאילתות קבוצתיות
- **אינדקס על Team** לסטטיסטיקות קבוצתיות

### אבטחת מסד הנתונים

- **מיגרציית אבטחה דו-שלבית** (עדכונים עדכניים):
  - AddPasswordHash: הוספת שדה PasswordHash לצד Password
  - RemovePasswordColumn: הסרת שדה Password הלא מאובטח
- **אימות נתונים** ברמת המודל ומסד הנתונים
- **הגנה מפני SQL Injection** באמצעות Entity Framework
- **הצפנת סיסמאות BCrypt** - הגנה מפני חשיפת מסד הנתונים
- **אימות בטוח עם בדיקת hash** במקום השוואת מחרוזות

## תהליך פיתוח

### שלב 1: תכנון ותיעוד (מרץ 2025)

- **הגדרת דרישות המערכת** - זיהוי צרכי משתמשים ותכונות נדרשות
- **תכנון מסד הנתונים** - עיצוב טבלאות Users ו-GameStats
- **תכנון ארכיטקטורה** - בחירת MVC Pattern עם Entity Framework
- **יצירת מיגרציות ראשוניות** - InitialCreate ו-MakeUsernameUnique

### שלב 2: פיתוח Backend (מרץ-מאי 2025)

- **יצירת מודלים בסיסיים** - User ו-GameStats עם אימותים
- **פיתוח Controllers** - HomeController, UserController, StatsController
- **הגדרת Entity Framework** - הקשר לבסיס נתונים עם SQLite
- **מערכת אימות** - התחברות, רישום ומערכת הרשאות
- **אינטגרציה עם NBA API** - DataController עם HttpClient

### שלב 3: פיתוח Frontend ו-UX (מאי 2025)

- **עיצוב ממשק בעברית** - תמיכה מלאה ב-RTL
- **יישום Bootstrap** - עיצוב רספונסיבי ומותאם לנייד
- **יצירת Views מתקדמים** - טבלאות סטטיסטיקות עם צבעי ביצועים
- **אינטגרציה עם Chart.js** - גרפים וחזותיות לנתונים
- **לוגואי קבוצות** - השגה ואינטגרציה של כל 30 לוגואי NBA

### שלב 4: תכונות מתקדמות (מאי 2025)

- **הוספת GameStats מלא** - מיגרציה לסטטיסטיקות מקיפות
- **אינדקסים למהירות** - אופטימיזציה לביצועים בשאילתות
- **מערכת ניהול משתמשים מקיפה** (commit 6e3a3e4):
  - הוספת שדה IsAdmin לטבלת Users
  - יצירת מיגרציה AddIsAdminToUser
  - פיתוח ממשק ניהול משתמשים (ManageUsers.cshtml)
  - יצירת עמוד עריכת משתמש (EditUser.cshtml)
  - הוספת קישורי ניהול בתפריט הניווט
  - הוספת פונקציות מחיקה ועריכה ב-HomeController
- **ייבוא נתונים** - יכולת ייבוא CSV ועדכון מ-NBA API
- **שיפורי UX** - צבעי ביצועים, מדדי יעילות, זיהוי הישגים

### שלב 5: אבטחה ואופטימיזציה (מאי 2025)

- **שדרוג אבטחה מתקדם** - מעבר מסיסמאות ברורות להצפנת BCrypt (עדיין לא מועבר)
- **מיגרציית אבטחה דו-שלבית**:
  - מיגרציה AddPasswordHash - הוספת שדה PasswordHash
  - מיגרציה RemovePasswordColumn - הסרת שדה Password הלא מאובטח
- **שיפורי מודל User**:
  - מתודות SetPassword() ו-VerifyPassword() עם BCrypt
  - החלפת Password ב-PasswordHash
  - שילוב BCrypt.Net-Next 4.0.3
- **שיפורי UserController**:
  - אימות מאובטח עם VerifyPassword()
  - רישום עם הצפנת סיסמאות
  - טיפול משופר בשגיאות מסד נתונים
  - הגנה מפני שינוי הרשאות IsAdmin
- **בדיקות ביצועים** - אופטימיזציה של שאילתות מסד נתונים
- **שיפורי UX ואימות**:
  - שיפור טפסי רישום ועריכה
  - תצוגת שגיאות משופרת
  - סטנדרטיזציה של ערכי מגדר

## הוראות הפעלה

### דרישות מערכת

- **.NET 8.0 SDK** - פלטפורמת הפיתוח
- **Visual Studio 2022 או VS Code** - סביבת הפיתוח
- **SQLite** - מסד הנתונים (נכלל ב-.NET)
- **חיבור אינטרנט** - לאינטגרציה עם NBA API

### הפעלת הפרויקט

```bash
# שחזור כל החבילות הנדרשות
dotnet restore

# הפעלת מיגרציות מסד הנתונים
dotnet ef database update

# בנייה של הפרויקט
dotnet build

# הפעלת השרת המקומי
dotnet run
```

### גישה למערכת

- **כתובת:** <https://localhost:5001> או <http://localhost:5000>
- **רישום:** יצירת משתמש חדש בעמוד הרישום
- **כניסה:** התחברות עם שם משתמש וסיסמה
- **מנהל:** משתמש עם הרשאות מנהל יכול לגשת לניהול משתמשים ועדכון נתונים

## אתגרים טכניים שנפתרו

### 1. אינטגרציה עם NBA API

- **אתגר:** שליפת נתונים מ-API רשמי עם authentication מורכב
- **פתרון:** יישום HttpClient עם headers מותאמים ועיבוד JSON אוטומטי
- **תוצאה:** עדכון נתונים בזמן אמת מהמקור הרשמי

### 2. אבטחת סיסמאות מתקדמת

- **אתגר:** אחסון סיסמאות ברורות במסד הנתונים - סיכון אבטחה חמור
- **פתרון מתקדם:**
  - הטמעת BCrypt.Net-Next 4.0.3 עם הצפנת salt אוטומטית
  - מיגרציה דו-שלבית למעבר בטוח מסיסמאות ברורות
  - מתודות SetPassword() ו-VerifyPassword() במודל User
  - שינוי תהליך אימות לבדיקת hash במקום השוואה
- **תוצאה:** אבטחה ברמה תעשייתית - סיסמאות מוגנות גם במקרה של חשיפת מסד נתונים

### 3. תמיכה מלאה בעברית

- **אתגר:** יישום RTL, תרגום מלא ותמיכה בפורמטי תאריך עבריים
- **פתרון:** CSS מותאם ל-RTL, תרגום כל הטקסטים ופורמטים מקומיים
- **תוצאה:** חוויית משתמש טבעית ונוחה לדוברי עברית

### 4. ביצועים עם נתוני NBA גדולים

- **אתגר:** טיפול בעשרות אלפי רשומות סטטיסטיקות
- **פתרון:** אינדקסים מותאמים, שאילתות מותאמות ועיבוד batch
- **תוצאה:** זמני תגובה מהירים גם עם נתונים גדולים

### 5. ממשק משתמש מתקדם

- **אתגר:** הצגת סטטיסטיקות מורכבות בצורה ברורה ואינטואיטיבית
- **פתרון:** קידוד צבעים, גרפים אינטראקטיביים וחזותיות מתקדמות
- **תוצאה:** ממשק קל לשימוש המאפשר ניתוח מהיר של הנתונים

## טכנולוגיות מתקדמות שיושמו

### 1. Entity Framework Core עם אופטימיזציות

- **LINQ queries מותאמות** לביצועים מיטביים
- **אינדקסים מורכבים** לשאילתות מהירות
- **Migrations** לניהול שינויי סכמה

### 2. אינטגרציית API מתקדמת

- **HTTP Client** עם headers מותאמים
- **JSON Deserialization** אוטומטי לאובייקטים מקומיים
- **Error handling** מקיף לכשלי רשת

### 3. אבטחה מתקדמת

- **BCrypt hashing** עם salt אקראי
- **Role-based authentication** עם הרשאות מדורגות
- **Session management** מאובטח עם תפוגה

### 4. UX/UI מתקדם

- **Responsive design** המתאים לכל המכשירים
- **Performance indicators** עם צבעי ביצועים
- **Interactive charts** עם Chart.js
- **RTL support** מלא לעברית

## לקחים מקצועיים שנלמדו

### טכניים

- **חשיבות האבטחה** - הטמעת best practices מהשלב הראשון
- **ארכיטקטורת MVC** - הפרדה נקייה בין logic, data ו-presentation
- **API Integration** - טיפול בשירותים חיצוניים ו-error handling
- **Database optimization** - חשיבות האינדקסים והשאילתות המותאמות

### עיצוב ופיתוח

- **User Experience** - הבנת צרכי המשתמש וממשק אינטואיטיבי
- **Internationalization** - תמיכה בשפות שונות מהשלב הראשון
- **Performance** - אופטימיזציה לביצועים כחלק מהתכנון
- **Scalability** - בנייה למערכת שיכולה לגדול

### ניהול פרויקט

- **Documentation** - חשיבות התיעוד המתמשך
- **Version control** - ניהול שינויים עם Git
- **Testing approach** - בדיקות שוטפות במהלך הפיתוח
- **Deployment planning** - הכנה להפעלה בסביבת ייצור

---

**פרויקט זה פותח במסגרת לימודי מגמת פיזיקה מחשבים**  
**שנת הלימודים תשפ"ה**
