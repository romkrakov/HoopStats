@using HoopStats.Models
@model IEnumerable<HoopStats.Models.GameStats>

@{
    ViewData["Title"] = $"{ViewBag.PlayerName} - Stats";
}

<div class="container mt-4">
    <h2>@ViewBag.PlayerName's Statistics</h2>

    <div class="card mb-4">
        <div class="card-body">
            <h5 class="card-title">Season Averages</h5>
            <div class="row">
                <div class="col-md-3">
                    <div class="stat-box">
                        <span class="stat-label">PPG</span>
                        <span class="stat-value">@Model.Average(s => s.Points).ToString("F1")</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-box">
                        <span class="stat-label">RPG</span>
                        <span class="stat-value">@Model.Average(s => s.TotalRebounds).ToString("F1")</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-box">
                        <span class="stat-label">APG</span>
                        <span class="stat-value">@Model.Average(s => s.Assists).ToString("F1")</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-box">
                        <span class="stat-label">FG%</span>
                        <span class="stat-value">@{
                            var fga = Model.Sum(s => s.FieldGoalsAttempted);
                            if (fga > 0)
                            {
                                @((Model.Sum(s => s.FieldGoalsMade) * 100.0 / fga).ToString("F1"))@("%");
                            }
                            else
                            {
                                @("0.0%");
                            }
                        }</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="table-responsive">
        <table class="table table-striped align-middle">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Team</th>
                    <th>Opponent</th>
                    <th>MIN</th>
                    <th>PTS</th>
                    <th>REB</th>
                    <th>AST</th>
                    <th>STL</th>
                    <th>BLK</th>
                    <th>FG</th>
                    <th>3P</th>
                    <th>FT</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var stat in Model)
                {
                    <tr>
                        <td>@stat.GameDate.ToShortDateString()</td>
                        <td>
                            <div class="team-cell">
                                <img src="@TeamInfo.GetTeamLogoPath(stat.Team)" alt="@TeamInfo.GetTeamFullName(stat.Team)" class="team-logo" />
                                @TeamInfo.GetTeamFullName(stat.Team)
                            </div>
                        </td>
                        <td>
                            <div class="team-cell">
                                <img src="@TeamInfo.GetTeamLogoPath(stat.Opponent)" alt="@TeamInfo.GetTeamFullName(stat.Opponent)" class="team-logo" />
                                @TeamInfo.GetTeamFullName(stat.Opponent)
                            </div>
                        </td>
                        <td>@stat.MinutesPlayed.ToString("F1")</td>
                        <td>@stat.Points</td>
                        <td>@stat.TotalRebounds</td>
                        <td>@stat.Assists</td>
                        <td>@stat.Steals</td>
                        <td>@stat.Blocks</td>
                        <td>@stat.FieldGoalsMade/@stat.FieldGoalsAttempted</td>
                        <td>@stat.ThreePointersMade/@stat.ThreePointersAttempted</td>
                        <td>@stat.FreeThrowsMade/@stat.FreeThrowsAttempted</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

@section Styles {
    <style>
        .stat-box {
            text-align: center;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .stat-label {
            display: block;
            font-size: 14px;
            color: #6c757d;
        }

        .stat-value {
            display: block;
            font-size: 24px;
            font-weight: bold;
            color: #212529;
        }

        .team-cell {
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 180px;
            padding: 4px;
        }

        .team-logo {
            width: 30px;
            height: 30px;
            object-fit: contain;
            flex-shrink: 0;
        }

        @@media (max-width: 992px) {
            .team-cell {
                min-width: 150px;
                font-size: 0.9em;
            }
        }

        @@media (max-width: 768px) {
            .table-responsive {
                max-width: 100%;
                overflow-x: auto;
            }
            
            .team-cell {
                min-width: 120px;
                font-size: 0.85em;
            }

            .team-logo {
                width: 24px;
                height: 24px;
            }
        }
    </style>
}
